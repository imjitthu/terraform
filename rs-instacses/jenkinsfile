pipeline {
    agent any

    options { disableConcurrentBuilds() }

//    tools {
//        terraform 'terraform'
//    }

    stages {

        stage('installing roboshop components') {
            parallel { //parallal 1
                stage('installing catalogue') {
                    steps {
                        echo 'installing catalogue'
                        sh 'sleep 1s'
                        
                    }
                    }
                stage('installing cart') {
                     steps {
                        echo 'installing cart'
                        sh 'sleep 1s'
                    }
                    }
                stage('installing shipping') {
                    steps {
                        echo 'installing shipping'
                        sh 'sleep 1s'
                    }
                    }
                stage('installing user') {
                    steps {
                        echo 'installing user'
                        sh 'sleep 1s'
                    }
                    }
                stage('installing payment') {
                    steps {
                        echo 'installing payment'
                        sh 'sleep 1s'
                    }
                    }
                    } //parallel  1 
                    } //stage 
        stage('installing Databases') {
            parallel { //parallel 2
                stage('installing MongoDB') {
                    steps {
                       sh 'ansiible-playbook -i /root/inv roboshop.yml -t mongodb'   
                        }
                        }
                        
                stage('installing MySQL') {
                    steps('installing MySQL') {
                       sh 'ansiible-playbook -i /root/inv roboshop.yml -t mysql'
                    }
                    }                    
                    } //parallel 2
                    } //stage
        stage('installing Redis cache server') {
            steps {
                echo 'installing Redis Server'
                    }
                    }
        stage('installing RabbitMQ server') {
            steps {
                echo 'installing RabbitMQ Server'
                sh 'sleep 1s'
                    }
                    }
        stage('installing frontend web-server') {
            steps {
                sh'''
                echo 'installing frontend server'
                sleep 1s
                ''' }  
                    }
        stage('Roboshop components installed successfully') {
            steps {
                echo 'installing compononts finished'
                  }
                  }
        }
        }